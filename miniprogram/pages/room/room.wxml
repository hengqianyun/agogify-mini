<view class="video-room-page">
  <view class="video-content">
    <!-- <view wx:if="{{isWaiting}}" class="waiting-comp"></view> -->
    <live-pusher class="pusher" url="{{pusher.url}}" mode="{{pusher.mode}}" autopush="{{pusher.autopush}}" enable-camera="{{pusher.enableCamera}}" enable-mic="{{pusher.enableMic}}" muted="{{!pusher.enableMic}}" enable-agc="{{pusher.enableAgc}}" enable-ans="{{pusher.enableAns}}" enable-ear-monitor="{{pusher.enableEarMonitor}}" auto-focus="{{pusher.enableAutoFocus}}" zoom="{{pusher.enableZoom}}" min-bitrate="{{pusher.minBitrate}}" max-bitrate="{{pusher.maxBitrate}}" video-width="{{pusher.videoWidth}}" video-height="{{pusher.videoHeight}}" beauty="{{pusher.beautyLevel}}" whiteness="{{pusher.whitenessLevel}}" orientation="{{pusher.videoOrientation}}" aspect="{{pusher.videoAspect}}" device-position="{{pusher.frontCamera}}" remote-mirror="{{pusher.enableRemoteMirror}}" local-mirror="{{pusher.localMirror}}" background-mute="{{pusher.enableBackgroundMute}}" audio-quality="{{pusher.audioQuality}}" audio-volume-type="{{pusher.audioVolumeType}}" audio-reverb-type="{{pusher.audioReverbType}}" waiting-image="{{pusher.waitingImage}}" debug="{{debug}}" beauty-style="{{pusher.beautyStyle}}" filter="{{pusher.filter}}" bindstatechange="_pusherStateChangeHandler" bindnetstatus="_pusherNetStatusHandler" binderror="_pusherErrorHandler" bindbgmstart="_pusherBGMStartHandler" bindbgmprogress="_pusherBGMProgressHandler" bindbgmcomplete="_pusherBGMCompleteHandler" bindaudiovolumenotify="_pusherAudioVolumeNotify" />
    <view wx:for="{{playerList}}" wx:key="streamID" class="view-container player-container {{playerList.length===1? 'one-player':''}}" id="{{'player-'+item.streamID}}" data-userid="{{item.userID}}" data-streamtype="{{item.streamType}}" bindtap="_doubleTabToggleFullscreen">
      <live-player class="player" id="{{item.id}}" data-userid="{{item.userID}}" data-streamid="{{item.streamID}}" data-streamtype="{{item.streamType}}" src="{{item.src}}" mode="RTC" autoplay="{{item.autoplay}}" mute-audio="{{item.muteAudio}}" mute-video="{{item.muteVideo}}" orientation="{{item.orientation}}" object-fit="{{item.objectFit}}" background-mute="{{item.enableBackgroundMute}}" min-cache="{{item.minCache}}" max-cache="{{item.maxCache}}" sound-mode="{{item.soundMode}}" enable-recv-message="{{item.enableRecvMessage}}" auto-pause-if-navigate="{{item.autoPauseIfNavigate}}" auto-pause-if-open-native="{{item.autoPauseIfOpenNative}}" debug="{{debug}}" bindstatechange="_playerStateChange" bindfullscreenchange="_playerFullscreenChange" bindnetstatus="_playerNetStatus" bindaudiovolumenotify="_playerAudioVolumeNotify">
        <!-- <cover-view class="" scroll-top="1">
          <chat tim="{{tim}}" isReserve="{{isReserve}}" isReconnect="{{isReconnect}}" storeName="{{store.name}}" isWaiting="{{isWaiting}}" storeAvatar="{{store.avatar}}" storeId="{{store.id}}" userId="{{userId}}" groupId="{{groupId}}" saleId="{{saleId}}" bind:startVideo="startVideo"></chat>
        </cover-view> -->
      </live-player>
    </view>
    <waiting wx:if="{{isWaiting}}"></waiting>
    <!-- <chat isReserve="{{isReserve}}" isReconnect="{{isReconnect}}" storeName="{{store.name}}" isWaiting="{{isWaiting}}" storeAvatar="{{store.avatar}}" storeId="{{store.id}}" userId="{{userId}}" groupId="{{groupId}}" saleId="{{saleId}}" bind:startVideo="startVideo" bind:busy="handleShowBusyDialog"></chat> -->
    <chat wx:if="{{!showDialog && showChat}}" isReserve="{{isReserve}}" isReconnect="{{isReconnect}}" storeName="{{store.name}}" isWaiting="{{isWaiting}}" storeAvatar="{{store.avatar}}" storeId="{{store.id}}" userId="{{userId}}" groupId="{{groupId}}" saleId="{{saleId}}" bind:startVideo="startVideo" bind:busy="handleShowBusyDialog"></chat>
  </view>
  <RssDialog wx:if="{{showDialog}}" title="请注意" commitText="同意并继续" cancelText="不同意" bind:handleCommit="handleDialogCommit" bind:handleCancel="handleDialogCancel">
    <view class="dialog-content">
      <view class="dialog-item flex">
        <view class="dialog-title-left">1)</view>
        <view class="dialog-title-right">
          因海外实体专柜远程购物的特殊性原因，商品一经购买无法取消或退货。（请在购买前仔细核对尺码、颜色和商品品质）
        </view>
      </view>
      <view class="dialog-item flex">
        <view class="dialog-title-left">2)</view>
        <view class="dialog-title-right">通过本平台在实体专柜远程购物仅限您本人自用，且每天仅限购一件商品，否则您将承担由此产生的额外费用。</view>
      </view>
    </view>
  </RssDialog>
  <!-- <RssDialog wx:if="{{showYunDialog}}" title="请注意" commitText="同意并继续" cancelText="不同意" bind:handleCommit="handleDialogCommit" bind:handleCancel="handleDialogCancel">
    <view class="dialog-content">
      <view class="dialog-item flex">
        <view class="dialog-title-right">
          因海外实体专柜远程购物的特殊性原因，商品一经购买无法取消或退货。（请在购买前仔细核对尺码、颜色和商品品质）
        </view>
      </view>
      <view class="dialog-item flex">
        <view class="dialog-title-right">通过本平台在实体专柜远程购物仅限您本人自用，且每天仅限购一件商品，否则您将承担由此产生的额外费用。</view>
      </view>
    </view>
  </RssDialog> -->
  <wxs module="hasUser">
    module.exports = {
      getIsSalesInRoom: function(userList, saleId) {
        return userList.some(function(user) {return user.id == saleId} )
      }
    }
  </wxs>
  <RssDialog wx:if="{{showBusyDialog}}" title="销售忙碌中，请稍后再拨" commitText="确定" showCancel="{{true}}" bind:handleCommit="handleBusy"></RssDialog>
</view>